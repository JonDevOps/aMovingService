<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Moving Cost Estimator with Multiple Locations</title>
<script>
// Initial count for additional locations
var locationCount = 1;

// Function to add more location fields
function addLocation() {
    if (locationCount < 5) {
        var newFieldset = document.createElement('fieldset');
        newFieldset.innerHTML = '<legend>Location ' + locationCount + '</legend>' +
                                '<label for="location' + locationCount + '">Address:</label>' +
                                '<input type="text" id="location' + locationCount + '" name="location' + locationCount + '" required>' +
                                '<br><br>' +
                                '<label for="bedrooms' + locationCount + '">Number of Bedrooms:</label>' +
                                '<input type="number" id="bedrooms' + locationCount + '" name="bedrooms' + locationCount + '" min="0" required>' +
                                '<br><br>' +
                                '<label for="loadUnload' + locationCount + '">Load/Unload:</label>' +
                                '<select id="loadUnload' + locationCount + '" name="loadUnload' + locationCount + '">' +
                                '<option value="load">Load</option>' +
                                '<option value="unload">Unload</option>' +
                                '</select>';
        var form = document.getElementById('movingForm');
        form.insertBefore(newFieldset, document.getElementById('addLocBtn'));
        locationCount++;
    } else {
        alert('You can only add up to 4 additional locations.');
    }
}

// Function to calculate total cost
function calculateCost() {
    // Constants
    const costPerHour = 60;
    const minChargeHours = 2;
    const apiKey = 'YOUR_API_KEY'; // Replace with your actual API key

    // Get user input
    var startingLocation = document.getElementById('startingLocation').value;
    var finalLocation = document.getElementById('finalLocation').value;
    var bedrooms = parseInt(document.getElementById('bedrooms').value);

    // Calculate hours for bedrooms
    var hoursForBedrooms = Math.max(bedrooms, minChargeHours);

    // Initialize total travel time and additional time for bedrooms
    var totalTravelTimeSeconds = 0;
    var additionalTimeMinutes = 0;

    // Build the API request URL for the final location
    var locations = [finalLocation];
    for (var i = 1; i < locationCount; i++) {
        locations.push(document.getElementById('location' + i).value);
        additionalTimeMinutes += parseInt(document.getElementById('bedrooms' + i).value) * 30;
    }

    var apiUrl = 'https://maps.googleapis.com/maps/api/distancematrix/json?origins=' + encodeURIComponent(startingLocation) +
                 '&destinations=' + encodeURIComponent(locations.join('|')) +
                 '&key=' + apiKey;

    // Make the API request
    fetch(apiUrl)
        .then(response => response.json())
        .then(data => {
            // Extract distance and duration for the final location
            var element = data.rows[0].elements[0];
            totalTravelTimeSeconds += element.duration.value;
            document.getElementById('results').innerHTML = 'Final Location: ' +
                                                           element.distance.text + ', ' +
                                                           element.duration.text + '<br>';

            // Calculate total hours including additional time for bedrooms
            var totalHours = hoursForBedrooms + Math.ceil((totalTravelTimeSeconds / 3600) + (additionalTimeMinutes / 60));
            var totalCost = totalHours * costPerHour;

            // Display the total cost
            document.getElementById('results').innerHTML += '<br>Total Cost: $' + totalCost;
        })
        .catch(error => console.error('Error:', error));
}

// Prevent form from submitting
function handleForm(event) { event.preventDefault(); }
</script>
</head>
<body>

<h1>Moving Cost Estimator with Multiple Locations</h1>

<form id="movingForm" onsubmit="handleForm(event); calculateCost();">
    <label for="startingLocation">Starting Location:</label>
    <input type="text" id="startingLocation" name="startingLocation" required>
    <br><br>
    <label for="loadUnload">Load/Unload:</label>
    <select id="loadUnload" name="loadUnload">
        <option value="load">Load</option>
        <option value="unload">Unload</option>
    </select>
    <br><br>
    <label for="bedrooms">Number of Bedrooms:</label>
    <input type="number" id="bedrooms" name="bedrooms" min="1" required>
    <br><br>
    <label for="finalLocation">Final Location:</label>
    <input type="text" id="finalLocation" name="finalLocation" required>
    <br><br>
    <button type="button" id="addLocBtn" onclick="addLocation()">Add Another Location</button>
    <br><br>
    <input type="submit" value="Calculate Cost">
</form>

<div id="results"></div>

</body>
</html>
